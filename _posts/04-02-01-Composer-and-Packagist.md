---
title: Composer و Packagist
isChild: true
anchor: composer_and_packagist
---

## Composer و Packagist {#composer_and_packagist_title}

Composer یک مدیر بسته‌ی **فوق‌العاده** برای PHP است. وابستگی‌های پروژه‌ی خود را در یک فایل `composer.json` فهرست کنید و، با تنها چند فرمان ساده، تمام وابستگی‌ها دانلود شده و به صورت پیش‌فرض فراخوانی می‌شوند.

کتابخانه‌های بسیاری از PHP وجود دارند که با Composer سازگار هستند، که می‌توانید از آن‌ها استفاده کنید. این "بسته‌ها" در مخزن رسمی بسته‌های سازگار با Composer، یعنی [Packagist][1] فهرست شده‌اند.

### چگونگی نصب خودکار Composer

شما می‌توانید Composer را به صورت محلی (در دایرکتوری فعلی، که توصیه نمی‌شود) یا سراسری (برای نمونه در usr/local/bin/) نصب کنید. فرض کنیم می‌خواهید به صورت محلی نصب کنید. از دایرکتوری اصلی پروژه‌ی خود:

    curl -s https://getcomposer.org/installer | php
    
این فرمان `composer.phar` (فایل باینری PHP) را دانلود می‌کند. می‌توانید با استفاده از `php` برای مدیریت وابستگی‌ها در پروژه‌ی خود، از آن استفاده کنید. <strong>توجه کنید:</strong> اگر به صورت مستقیم کد دانلود شده را به یک مفسر (interpreter) ارجاع دهید، ابتدا از امن بودن کد اطمینان حاصل کنید.

#### نصب در ویندوز

برای کاربران ویندوز راحت‌ترین روش استفاده از نرم‌افزار [ComposerSetup][6] است، که نصب را به صورت سراسری انجام می‌دهد و `PATH$` را طوری تنظیم می‌کند که بتوانید از هر دایرکتوری در خط فرمان، `composer` را فراخوانی کنید.

### چگونگی نصب دستی Composer

این روش نصب کمی پیچیدگی دارد; اگرچه، دلایل مختلفی وجود دارد که یک توسعه‌دهنده این روش را نسبت به روش خودکار ترجیح دهد. در نصب خودکار، بررسی می‌شود در محیط PHP شما:

- دارای حداقل نسخه‌ی سازگار باشد
- فایل‌های `phar` به درستی اجر شوند
- مجوزهای کافی در دایرکتوری وجود داشته باشد
- برخی افزونه‌ها (extensions) مشکل‌ساز اجرا نشوند
- برخی تنظیمات `php.ini` وجود داشته باشند

در صورتی که نصب دستی، هیچ کدام از موارد فوق را پوشش نمی‌دهد، البته شما باید تصمیم نهایی را بگیرید. در هر صورت، می‌توانید Composer را به صورت دستی با استفاده از فرمان‌های زیر نصب کنید:

    curl -s https://getcomposer.org/composer.phar -o $HOME/local/bin/composer
    chmod +x $HOME/local/bin/composer

مسیر `HOME/local/bin$` (یا هر دایرکتوری دیگر به انتخاب شما) باید در متغیر محیطی `PATH$` وجود داشته باشد. این کار منجر به ایجاد فرمان `composer` می‌گردد.

وقتی به مستندات مراجعه می‌کنید که می‌گوید Composer را با استفاده از `php composer.phar install` اجرا کنید، می‌توانید آن را با فرمان زیر جایگزین کنید:

    composer install

در ادامه فرض می‌کنیم که Composer را به صورت سراسری نصب کرده‌اید.

### ایجاد و نصب وابستگی‌ها

تمام وابستگی‌های پروژه‌ی شما در فایلی با نام `composer.json` توسط Composer ردیابی می‌شوند. می‌توانید خود آن را مدیریت کنید یا بگذارید Composer این کار را انجام دهد. فرمان `composer require` یک وابستگی برای پروژه تعریف می‌کند و اگر فایل `composer.json` وجود نداشته باشد، یکی ساخته می‌شود. برای نمونه، این فرمان [Twig][2] را به عنوان یک وابستگی برای پروژه تعریف می‌کند.

	composer require twig/twig:~1.8

همچنین فرمان `composer init` شما را در ایجاد یک فایل کامل `composer.json` راهنمایی می‌کند. در هر صورت، هر زمان که فایل `composer.json` ساخته شود می‌توانید به Composer بگویید تمام وابستگی‌های پروژه را در دایرکتوری `/vendors` دانلود و نصب کند. این شامل پروژه‌هایی هم می‌شود که خود یک فایل `composer.json` دارند:

    composer install

گام بعد اضافه کردن این خط کد در فایل اصلی PHP است; که به PHP می‌گوید از فراخوانی‌های Composer برای مدیریت وابستگی‌ها استفاده کند.

{% highlight php %}
<?php
require 'vendor/autoload.php';
{% endhighlight %}

هم اکنون می‌توانید از وابستگی‌های پروژه‌ی خود استفاده کنید و هر زمان لازم باشد به صورت خودکار فراخوانی می‌شوند.

### بروزرسانی وابستگی‌ها

وقتی برای اولین بار `php composer.phar install` را اجرا کردید، Composer فایلی با نام `composer.lock` را ایجاد می‌کند که نسخه‌ی دقیق هر بسته را در خود نگاه می‌دارد. زمانی که پروژه‌ی خود را با دیگران به اشتراک می‌گذارید و فایل `composer.lock` نیز همراه آن است، وقتی آن‌ها `php composer.phar install` را اجرا می‌کنند دقیقا همان نسخه از وابستگی‌ها را دریافت خواهند کرد. برای بروزرسانی وابستگی‌های خود، `php composer.phar update` را اجرا کنید.

این کار زمانی بسیار مفید است که در انتخاب نسخه‌ی وابستگی‌ها سخت‌گیری خاصی ندارید. برای نمونه، نیازمندی یک نسخه به 1.8~ یعنی "هر چیزی جدیدتر از 1.8.0 ولی قبل از 2.0". می‌توانید از `*` نیز در `*.1.8` استفاده کنید. حال فرمان `php composer.phar update` تمام وابستگی‌های شما را با توجه به محدودیتی که برایشان تعریف کرده‌اید، بروزرسانی خواهد کرد.

### اطلاعیه‌های بروزرسانی

برای دریافت اطلاعیه درباره‌ی آخرین نسخه‌ها می‌توانید در [VersionEye][3] ثبت نام کنید، سرویسی که با مشاهده‌ی فایل `composer.json` موجود در حساب GitHub و BitBucket شما، با انتشار هر نسخه‌ی جدید با ایمیل به شما خبر می‌دهد.

### بررسی مشکلات امنیتی در وابستگی‌ها

سرویس [Security Advisories Checker][4] که از خط فرمان نیز قابل اجرا است، با بررسی فایل `composer.lock` به شما می‌گوید آیا باید وابستگی‌های خود را بروزرسانی کنید یا خیر.

* [درباره‌ی Composer بیشتر بدانید][5]

[1]: http://packagist.org/
[2]: http://twig.sensiolabs.org
[3]: https://www.versioneye.com/
[4]: https://security.sensiolabs.org/
[5]: http://getcomposer.org/doc/00-intro.md
[6]: https://getcomposer.org/Composer-Setup.exe

