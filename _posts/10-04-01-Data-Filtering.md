---
title: بررسی داده‌ی ورودی
isChild: true
anchor: data_filtering
---

## بررسی داده‌ی ورودی {#data_filtering_title}

هیچگاه و به هیچ عنوان به داده‌ی ورودی از طرف کاربر اطمینان نکنید. قبل از اینکه داده را در کد مورد استفاده قرار دهید، همیشه آن را بررسی و کنترل کنید. با استفاده از توابع `filter_var` و `filter_input` می‌توانید از صحت داده‌ی ورودی اطمینان حاصل کنید (مانند ایمیل و ...).

داده‌ی ورودی شامل طیف گسترده‌ای است: متغیرهای `GET_$` و `POST_$` از طریق فرم، برخی مقادیر درون متغیر `SERVER_$` و حتی درخواست HTTP با استفاده از `('php://input')fopen`. به یاد داشته باشید که داده‌ی ورودی تنها از طریق فرم‌هایی که کاربران پر می‌کنند به دست نمی‌آید و مواردی مانند دانلود و آپلود فایل، مقدارهای موجود در session، داده cookie و داده‌ی مربوط به سرویس‌های دیگر، همگی از این طیف گسترده هستند.

هرچند داده‌ی ورودی قابل ذخیره‌سازی، ترکیب و دسترسی در زمان دیگر است، کماکان داده‌ی ناامن به حساب می‌آید. هر زمان که قصد پردازش، خروجی‌گرفتن، الحاق کردن یا استفاده از آن را در کد داشتید از خود بپرسید آیا می‌توان به این داده اطمینان کرد یا خیر.

هر نوع داده‌ای با توجه به کاربردش می‌تواند به یک شکل _فیلتر_ شود. برای نمونه، زمانی که داده‌ی ورودی بدون بررسی و کنترل به صورت مستقیم در ساختار HTML قرار می‌گیرد این تهدید وجود دارد که عملیات غیرمجازی را توسط JavaScript روی وبسایت شما انجام دهد! این نوع آسیب‌پذیری، Cross-Site Scripting یا XSS نامیده می‌شود که یکی از خطرناکترین حملات متداول است. یک روش برای جلوگیری از این حمله، بررسی و کنترل داده‌ی ورودی کاربر قبل از قرار گرفتن در ساختار نهایی صفحه است که می‌تواند با استفاده از تابع `strip_tags` صورت پذیرد. برای نادیده گرفتن برخی کاراکترهای خاص توابعی مانند `htmlentities` و `htmlspecialchars` مورد استفاده قرار می‌گیرند.

نمونه‌ی دیگر استفاده از داده‌ی ورودی جهت اجرا در محیط خط فرمان است. این کار بسیار خطرناک (و در عین حال اصلا توصیه نمی‌شود) است اما می‌توان از تابع `escapeshellarg` برای بررسی و کنترل داده‌ی ارسالی استفاده کرد.

به عنوان نمونه‌ی آخر به دریافت فایل توسط کاربر از روی سرور اشاره می‌کنیم. این کار می‌تواند با تغییر نام فایل به مسیر فایل صورت بگیرد که در صورت بررسی نکردن داده‌ی ورودی، اطلاعات مهم سرور در اختیار دیگران قرار می‌گیرد. برای جلوگیری از این امر باید کاراکترهای "/"، "/.."، و [null bytes][6] یا سایر کاراکترها را حذف کرد تا منجر به نمایش مکان‌های مخفی در سرور نشوند.

* [درباره‌ی بررسی و کنترل داده بیشتر بدانید][1]
* [درباره‌ی تابع `filter_var` بیشتر بدانید][4]
* [درباره‌ی تابع `filter_input` بیشتر بدانید][5]
* [درباره‌ی بررسی و مدیریت بایت‌های خالی بیشتر بدانید][6]

### پاکسازی داده‌ی ورودی

این فرآیند، با حذف یا نادیده‌گرفتن برخی کاراکترهای ناامن از داده‌ی ورودی، صورت می‌گیرد.

برای نمونه، قبل از قرار دادن داده‌ی ورودی در خروجی نهایی یا درج آن در پایگاه‌داده باید آن را از کاراکترهای غیرمجاز پاکسازی کنید. عمل تخصیص پارامتر به یک پرس‌وجو توسط [PDO](#databases) اینکار را برای شما انجام می‌دهد.

گاهی اوقات لازم است به برخی تگ‌های امن HTML اجازه‌ی قرارگیری در صفحه داده شود. مدیریت این فرآیند گاهی بسیار دشوار می‌شود تا جایی که برخی ترجیح می‌دهند از پیش‌پردازنده‌هایی مانند Markdown یا BBCode استفاده کنند و کتابخانه‌هایی مانند [HTML Purifier][html-purifier] به همین منظور وجود دارند.

[مشاهده‌ی فیلترهای به کار رفته در پاکسازی داده‌ی ورودی][2]

### اعتبارسنجی

این فرآیند به شما کمک می‌کند از صحت اطلاعات ورودی اطمینان حاصل کنید. برای نمونه، هنگام پردازش یک فرم ثبت‌نام، شاید بخواهید ایمیل، شماره تلفن یا سن فرد را بررسی و کنترل کنید.

[مشاهده‌ی فیلترهای به کار رفته در اعتبارسنجی داده‌ی ورودی][3]

[1]: http://www.php.net/manual/en/book.filter.php
[2]: http://www.php.net/manual/en/filter.filters.sanitize.php
[3]: http://www.php.net/manual/en/filter.filters.validate.php
[4]: http://php.net/manual/en/function.filter-var.php
[5]: http://www.php.net/manual/en/function.filter-input.php
[6]: http://php.net/manual/en/security.filesystem.nullbytes.php
[html-purifier]: http://htmlpurifier.org/
